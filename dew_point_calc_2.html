<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор точки росы кислотной коррозии | Acid Dew Point Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <style>
        :root {
            --primary-color: #0c4da2;
            --secondary-color: #3a7bd5;
            --accent-color: #00bcd4;
            --danger-zone: rgba(255, 0, 0, 0.1);
            --warning-zone: rgba(255, 165, 0, 0.1);
            --safe-zone: rgba(0, 128, 0, 0.1);
        }

        body {
            font-family: 'Roboto', 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .header-gradient {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .tab-active {
            border-bottom: 3px solid var(--accent-color);
            color: var(--primary-color);
            font-weight: 600;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background-color: var(--secondary-color);
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }

        .form-control {
            display: block;
            width: 100%;
            padding: 0.5rem;
            font-size: 1rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-control:focus {
            border-color: var(--secondary-color);
            outline: 0;
            box-shadow: 0 0 0 0.2rem rgba(58, 123, 213, 0.25);
        }

        .range-slider {
            width: 100%;
            height: 5px;
            border-radius: 5px;
            background: #d7dcdf;
            outline: none;
            -webkit-appearance: none;
        }

        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--secondary-color);
            cursor: pointer;
            border: none;
        }

        .range-slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--secondary-color);
            cursor: pointer;
            border: none;
        }

        .parameter-card {
            transition: all 0.3s ease;
        }

        .parameter-card:hover {
            transform: translateY(-5px);
        }

        .result-card {
            border-left: 4px solid var(--primary-color);
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .method-description {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }

        .method-description.active {
            max-height: 1000px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        .corrosion-risk-low {
            background-color: var(--safe-zone);
            color: darkgreen;
        }

        .corrosion-risk-medium {
            background-color: var(--warning-zone);
            color: darkorange;
        }

        .corrosion-risk-high {
            background-color: var(--danger-zone);
            color: darkred;
        }

        .lang-ru, .lang-en {
            display: none;
        }

        .table-striped tbody tr:nth-of-type(odd) {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .equation {
            font-family: 'Times New Roman', Times, serif;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            display: inline-block;
            margin: 10px 0;
        }

        .print-friendly {
            color-adjust: exact;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        @media print {
            .no-print {
                display: none;
            }
            .page-break {
                page-break-before: always;
            }
            body {
                font-size: 12pt;
            }
            .card {
                break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }

            .grid-cols-2, .grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="print-friendly">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="header-gradient text-white py-6 px-4 rounded-lg shadow-lg mb-8">
            <div class="flex flex-wrap items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold lang-ru">Калькулятор точки росы кислотной коррозии</h1>
                    <h1 class="text-3xl font-bold lang-en">Acid Dew Point Calculator</h1>
                    <p class="text-sm mt-2 max-w-lg lang-ru">Научно точный инструмент для расчета температуры точки росы H₂SO₄, HCl и H₂S в газовых потоках</p>
                    <p class="text-sm mt-2 max-w-lg lang-en">Scientifically accurate tool for calculating acid dew point temperatures of H₂SO₄, HCl, and H₂S in gas streams</p>
                </div>
                <div class="flex items-center mt-4 sm:mt-0">
                    <button id="langToggle" class="btn-primary flex items-center">
                        <i class="fas fa-globe mr-2"></i>
                        <span class="lang-ru">EN</span>
                        <span class="lang-en">RU</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Tab Navigation -->
            <div class="flex flex-wrap border-b border-gray-200 mb-6 no-print">
                <button class="tab-btn px-4 py-2 mr-2 tab-active" data-tab="calculator">
                    <i class="fas fa-calculator mr-2"></i>
                    <span class="lang-ru">Калькулятор</span>
                    <span class="lang-en">Calculator</span>
                </button>
                <button class="tab-btn px-4 py-2 mr-2" data-tab="theory">
                    <i class="fas fa-book mr-2"></i>
                    <span class="lang-ru">Теория и формулы</span>
                    <span class="lang-en">Theory & Formulas</span>
                </button>
                <button class="tab-btn px-4 py-2 mr-2" data-tab="recommendations">
                    <i class="fas fa-shield-alt mr-2"></i>
                    <span class="lang-ru">Рекомендации</span>
                    <span class="lang-en">Recommendations</span>
                </button>
                <button class="tab-btn px-4 py-2" data-tab="references">
                    <i class="fas fa-book-open mr-2"></i>
                    <span class="lang-ru">Источники</span>
                    <span class="lang-en">References</span>
                </button>
            </div>

            <!-- Calculator Tab Content -->
            <div id="calculator" class="tab-content active fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Input Parameters Section -->
                    <div class="lg:col-span-1">
                        <div class="card p-6 mb-6">
                            <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">
                                <i class="fas fa-sliders-h mr-2 text-blue-600"></i>
                                <span class="lang-ru">Параметры расчета</span>
                                <span class="lang-en">Calculation Parameters</span>
                            </h2>

                            <!-- Acid Type Selection -->
                            <div class="mb-4">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Тип кислоты</span>
                                    <span class="lang-en">Acid Type</span>
                                </label>
                                <div class="grid grid-cols-3 gap-2">
                                    <button id="acid-h2so4" class="acid-type-btn btn-primary py-2 px-3 rounded-md text-sm" data-acid="h2so4">H₂SO₄</button>
                                    <button id="acid-hcl" class="acid-type-btn bg-gray-200 text-gray-700 py-2 px-3 rounded-md text-sm" data-acid="hcl">HCl</button>
                                    <button id="acid-h2s" class="acid-type-btn bg-gray-200 text-gray-700 py-2 px-3 rounded-md text-sm" data-acid="h2s">H₂S</button>
                                </div>
                            </div>

                            <!-- Calculation Method -->
                            <div class="mb-4" id="method-selection-h2so4">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Метод расчета</span>
                                    <span class="lang-en">Calculation Method</span>
                                </label>
                                <select id="calculation-method-h2so4" class="form-control">
                                    <option value="okkes" class="lang-ru">Okkes (1987) - стандартный метод</option>
                                    <option value="okkes" class="lang-en">Okkes (1987) - standard method</option>
                                    <option value="verhoff" class="lang-ru">Verhoff & Banchero (1974)</option>
                                    <option value="verhoff" class="lang-en">Verhoff & Banchero (1974)</option>
                                    <option value="zarenezhad" class="lang-ru">ZareNezhad (2009)</option>
                                    <option value="zarenezhad" class="lang-en">ZareNezhad (2009)</option>
                                    <option value="all" class="lang-ru">Все методы (сравнение)</option>
                                    <option value="all" class="lang-en">All methods (comparison)</option>
                                </select>
                            </div>

                            <div class="mb-4 hidden" id="method-selection-hcl">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Метод расчета</span>
                                    <span class="lang-en">Calculation Method</span>
                                </label>
                                <select id="calculation-method-hcl" class="form-control">
                                    <option value="kiang" class="lang-ru">Kiang (1981)</option>
                                    <option value="kiang" class="lang-en">Kiang (1981)</option>
                                </select>
                            </div>

                            <div class="mb-4 hidden" id="method-selection-h2s">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Метод расчета</span>
                                    <span class="lang-en">Calculation Method</span>
                                </label>
                                <select id="calculation-method-h2s" class="form-control">
                                    <option value="antoine" class="lang-ru">Уравнение Антуана (NIST)</option>
                                    <option value="antoine" class="lang-en">Antoine Equation (NIST)</option>
                                </select>
                            </div>

                            <!-- Water Content -->
                            <div class="mb-4">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Содержание воды (H₂O)</span>
                                    <span class="lang-en">Water Content (H₂O)</span>
                                </label>
                                <div class="flex mb-2">
                                    <input type="number" id="water-content" class="form-control mr-2" value="10" min="0" max="100" step="0.1">
                                    <select id="water-units" class="form-control w-24">
                                        <option value="percent">% об.</option>
                                        <option value="ppm">ppm</option>
                                        <option value="mg/nm3">мг/нм³</option>
                                    </select>
                                </div>
                                <input type="range" id="water-content-slider" class="range-slider" min="0" max="30" value="10" step="0.1">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0%</span>
                                    <span>15%</span>
                                    <span>30%</span>
                                </div>
                            </div>

                            <!-- Acid Content (SO3) -->
                            <div class="mb-4" id="so3-content-container">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Содержание SO₃</span>
                                    <span class="lang-en">SO₃ Content</span>
                                    <span class="tooltip">
                                        <i class="fas fa-info-circle text-blue-500"></i>
                                        <span class="tooltiptext lang-ru">В дымовых газах обычно 2-4% SO₂ конвертируется в SO₃</span>
                                        <span class="tooltiptext lang-en">In flue gases, typically 2-4% of SO₂ is converted to SO₃</span>
                                    </span>
                                </label>
                                <div class="flex mb-2">
                                    <input type="number" id="so3-content" class="form-control mr-2" value="5" min="0" max="1000" step="1">
                                    <select id="so3-units" class="form-control w-24">
                                        <option value="ppm">ppm</option>
                                        <option value="percent">% об.</option>
                                        <option value="mg/nm3">мг/нм³</option>
                                    </select>
                                </div>
                                <input type="range" id="so3-content-slider" class="range-slider" min="0" max="100" value="5" step="1">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0 ppm</span>
                                    <span>50 ppm</span>
                                    <span>100 ppm</span>
                                </div>
                            </div>

                            <!-- Acid Content (HCl) -->
                            <div class="mb-4 hidden" id="hcl-content-container">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Содержание HCl</span>
                                    <span class="lang-en">HCl Content</span>
                                </label>
                                <div class="flex mb-2">
                                    <input type="number" id="hcl-content" class="form-control mr-2" value="100" min="0" max="10000" step="1">
                                    <select id="hcl-units" class="form-control w-24">
                                        <option value="ppm">ppm</option>
                                        <option value="percent">% об.</option>
                                        <option value="mg/nm3">мг/нм³</option>
                                    </select>
                                </div>
                                <input type="range" id="hcl-content-slider" class="range-slider" min="0" max="1000" value="100" step="10">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0 ppm</span>
                                    <span>500 ppm</span>
                                    <span>1000 ppm</span>
                                </div>
                            </div>

                            <!-- Acid Content (H2S) -->
                            <div class="mb-4 hidden" id="h2s-content-container">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Содержание H₂S</span>
                                    <span class="lang-en">H₂S Content</span>
                                </label>
                                <div class="flex mb-2">
                                    <input type="number" id="h2s-content" class="form-control mr-2" value="1" min="0" max="100" step="0.1">
                                    <select id="h2s-units" class="form-control w-24">
                                        <option value="percent">% об.</option>
                                        <option value="ppm">ppm</option>
                                        <option value="mg/nm3">мг/нм³</option>
                                    </select>
                                </div>
                                <input type="range" id="h2s-content-slider" class="range-slider" min="0" max="10" value="1" step="0.1">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0%</span>
                                    <span>5%</span>
                                    <span>10%</span>
                                </div>
                            </div>

                            <!-- System Pressure -->
                            <div class="mb-4">
                                <label class="block text-gray-700 font-medium mb-2">
                                    <span class="lang-ru">Давление системы</span>
                                    <span class="lang-en">System Pressure</span>
                                </label>
                                <div class="flex mb-2">
                                    <input type="number" id="system-pressure" class="form-control mr-2" value="1" min="0.1" max="10" step="0.01">
                                    <select id="pressure-units" class="form-control w-24">
                                        <option value="atm">атм</option>
                                        <option value="bar">бар</option>
                                        <option value="kPa">кПа</option>
                                        <option value="mmHg">мм рт.ст.</option>
                                    </select>
                                </div>
                                <input type="range" id="system-pressure-slider" class="range-slider" min="0.5" max="2" value="1" step="0.01">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0.5 атм</span>
                                    <span>1 атм</span>
                                    <span>2 атм</span>
                                </div>
                            </div>

                            <!-- Calculate Button -->
                            <button id="calculate-btn" class="btn-primary w-full py-3 font-bold text-lg">
                                <i class="fas fa-calculator mr-2"></i>
                                <span class="lang-ru">Рассчитать</span>
                                <span class="lang-en">Calculate</span>
                            </button>
                        </div>

                        <!-- Intermediate Values Card -->
                        <div class="card p-6">
                            <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">
                                <i class="fas fa-microscope mr-2 text-blue-600"></i>
                                <span class="lang-ru">Промежуточные значения</span>
                                <span class="lang-en">Intermediate Values</span>
                            </h2>
                            <div id="intermediate-values">
                                <div class="mb-3">
                                    <span class="font-medium lang-ru">Парциальное давление H₂O:</span>
                                    <span class="font-medium lang-en">H₂O Partial Pressure:</span>
                                    <span id="h2o-partial-pressure" class="ml-2">76.0 мм рт.ст.</span>
                                </div>
                                <div class="mb-3" id="so3-partial-section">
                                    <span class="font-medium lang-ru">Парциальное давление SO₃:</span>
                                    <span class="font-medium lang-en">SO₃ Partial Pressure:</span>
                                    <span id="so3-partial-pressure" class="ml-2">0.0038 мм рт.ст.</span>
                                </div>
                                <div class="mb-3 hidden" id="hcl-partial-section">
                                    <span class="font-medium lang-ru">Парциальное давление HCl:</span>
                                    <span class="font-medium lang-en">HCl Partial Pressure:</span>
                                    <span id="hcl-partial-pressure" class="ml-2">0.076 мм рт.ст.</span>
                                </div>
                                <div class="mb-3 hidden" id="h2s-partial-section">
                                    <span class="font-medium lang-ru">Парциальное давление H₂S:</span>
                                    <span class="font-medium lang-en">H₂S Partial Pressure:</span>
                                    <span id="h2s-partial-pressure" class="ml-2">7.6 мм рт.ст.</span>
                                </div>
                                <div class="text-xs text-gray-500 mt-4 border-t pt-2">
                                    <p class="lang-ru">Значения пересчитаны в единицы, используемые в формулах</p>
                                    <p class="lang-en">Values are converted to units used in formulas</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Results and Graphs Section -->
                    <div class="lg:col-span-2">
                        <!-- Results Card -->
                        <div class="card p-6 mb-6 result-card">
                            <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">
                                <i class="fas fa-thermometer-half mr-2 text-blue-600"></i>
                                <span class="lang-ru">Результаты расчета</span>
                                <span class="lang-en">Calculation Results</span>
                            </h2>
                            <div id="results">
                                <!-- Calculation Results Will Be Displayed Here -->
                                <div id="single-method-results">
                                    <div class="flex flex-wrap gap-4">
                                        <div class="parameter-card bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-100 flex-1 min-w-[240px] fade-in">
                                            <h3 class="font-bold text-blue-800 mb-2">
                                                <span class="lang-ru">Точка росы H₂SO₄</span>
                                                <span class="lang-en">H₂SO₄ Dew Point</span>
                                            </h3>
                                            <div class="flex items-end">
                                                <span id="h2so4-dew-point" class="text-4xl font-bold text-blue-900">130.5</span>
                                                <span class="text-xl ml-1 text-blue-700">°C</span>
                                            </div>
                                            <div class="text-sm text-blue-600 mt-1" id="h2so4-dew-point-f">(266.9 °F)</div>
                                            <div class="text-xs text-gray-500 mt-2">
                                                <span class="lang-ru">Метод: Okkes (1987)</span>
                                                <span class="lang-en">Method: Okkes (1987)</span>
                                            </div>
                                        </div>

                                        <div class="parameter-card bg-green-50 p-4 rounded-lg shadow-sm border border-green-100 flex-1 min-w-[240px] fade-in">
                                            <h3 class="font-bold text-green-800 mb-2">
                                                <span class="lang-ru">Рекомендуемая температура</span>
                                                <span class="lang-en">Recommended Temperature</span>
                                            </h3>
                                            <div class="flex items-end">
                                                <span id="recommended-temp" class="text-4xl font-bold text-green-900">140.5</span>
                                                <span class="text-xl ml-1 text-green-700">°C</span>
                                            </div>
                                            <div class="text-sm text-green-600 mt-1" id="recommended-temp-f">(284.9 °F)</div>
                                            <div class="text-xs text-gray-500 mt-2">
                                                <span class="lang-ru">С запасом +10°C от точки росы</span>
                                                <span class="lang-en">With +10°C safety margin</span>
                                            </div>
                                        </div>

                                        <div class="parameter-card bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-100 flex-1 min-w-[240px] fade-in">
                                            <h3 class="font-bold text-gray-800 mb-2">
                                                <span class="lang-ru">Точка росы воды</span>
                                                <span class="lang-en">Water Dew Point</span>
                                            </h3>
                                            <div class="flex items-end">
                                                <span id="water-dew-point" class="text-4xl font-bold text-gray-900">45.8</span>
                                                <span class="text-xl ml-1 text-gray-700">°C</span>
                                            </div>
                                            <div class="text-sm text-gray-600 mt-1" id="water-dew-point-f">(114.4 °F)</div>
                                            <div class="text-xs text-gray-500 mt-2">
                                                <span class="lang-ru">При 10% об. H₂O и 1 атм</span>
                                                <span class="lang-en">At 10% vol. H₂O and 1 atm</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Comparison Results (For All Methods) -->
                                <div id="comparison-results" class="hidden mt-4">
                                    <table class="table-striped min-w-full">
                                        <thead>
                                            <tr class="bg-gray-100">
                                                <th class="px-4 py-2 text-left">
                                                    <span class="lang-ru">Метод</span>
                                                    <span class="lang-en">Method</span>
                                                </th>
                                                <th class="px-4 py-2 text-left">
                                                    <span class="lang-ru">Точка росы (°C)</span>
                                                    <span class="lang-en">Dew Point (°C)</span>
                                                </th>
                                                <th class="px-4 py-2 text-left">
                                                    <span class="lang-ru">Точка росы (°F)</span>
                                                    <span class="lang-en">Dew Point (°F)</span>
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="px-4 py-2 font-medium">Okkes (1987)</td>
                                                <td class="px-4 py-2" id="okkes-result">130.5 °C</td>
                                                <td class="px-4 py-2" id="okkes-result-f">266.9 °F</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-2 font-medium">Verhoff (1974)</td>
                                                <td class="px-4 py-2" id="verhoff-result">122.3 °C</td>
                                                <td class="px-4 py-2" id="verhoff-result-f">252.1 °F</td>
                                            </tr>
                                            <tr>
                                                <td class="px-4 py-2 font-medium">ZareNezhad (2009)</td>
                                                <td class="px-4 py-2" id="zarenezhad-result">126.8 °C</td>
                                                <td class="px-4 py-2" id="zarenezhad-result-f">260.2 °F</td>
                                            </tr>
                                            <tr class="bg-blue-50">
                                                <td class="px-4 py-2 font-medium text-blue-800">
                                                    <span class="lang-ru">Максимальное значение</span>
                                                    <span class="lang-en">Maximum Value</span>
                                                </td>
                                                <td class="px-4 py-2 font-bold text-blue-800" id="max-result">130.5 °C</td>
                                                <td class="px-4 py-2 font-bold text-blue-800" id="max-result-f">266.9 °F</td>
                                            </tr>
                                            <tr class="bg-green-50">
                                                <td class="px-4 py-2 font-medium text-green-800">
                                                    <span class="lang-ru">Рекомендуемая температура</span>
                                                    <span class="lang-en">Recommended Temperature</span>
                                                </td>
                                                <td class="px-4 py-2 font-bold text-green-800" id="recommended-result">140.5 °C</td>
                                                <td class="px-4 py-2 font-bold text-green-800" id="recommended-result-f">284.9 °F</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                                <!-- Risk Assessment -->
                                <div class="mt-6 p-4 rounded-lg" id="risk-assessment">
                                    <h3 class="font-bold text-lg mb-2">
                                        <i class="fas fa-exclamation-triangle mr-2 text-yellow-500"></i>
                                        <span class="lang-ru">Оценка риска коррозии</span>
                                        <span class="lang-en">Corrosion Risk Assessment</span>
                                    </h3>
                                    <p id="risk-description" class="mb-2">
                                        <span class="lang-ru">При работе оборудования на температурах ниже точки росы кислоты существует риск интенсивной коррозии.</span>
                                        <span class="lang-en">Operating equipment at temperatures below the acid dew point poses a risk of intensive corrosion.</span>
                                    </p>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 mt-3">
                                        <div class="corrosion-risk-high p-2 rounded-md text-center">
                                            <div class="font-medium">T < Tdp</div>
                                            <div class="text-sm lang-ru">Высокий риск</div>
                                            <div class="text-sm lang-en">High Risk</div>
                                        </div>
                                        <div class="corrosion-risk-medium p-2 rounded-md text-center">
                                            <div class="font-medium">Tdp < T < Tdp + 10°C</div>
                                            <div class="text-sm lang-ru">Средний риск</div>
                                            <div class="text-sm lang-en">Medium Risk</div>
                                        </div>
                                        <div class="corrosion-risk-low p-2 rounded-md text-center">
                                            <div class="font-medium">T > Tdp + 10°C</div>
                                            <div class="text-sm lang-ru">Низкий риск</div>
                                            <div class="text-sm lang-en">Low Risk</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Graph Card -->
                        <div class="card p-6">
                            <h2 class="text-xl font-bold mb-4 text-gray-800 border-b pb-2">
                                <i class="fas fa-chart-line mr-2 text-blue-600"></i>
                                <span class="lang-ru">Графический анализ</span>
                                <span class="lang-en">Graphical Analysis</span>
                            </h2>

                            <!-- Graph Controls -->
                            <div class="flex flex-wrap gap-2 mb-4">
                                <button id="graph-type-h2o" class="graph-type-btn btn-primary py-1 px-3 rounded-md text-sm">
                                    <span class="lang-ru">Зависимость от H₂O</span>
                                    <span class="lang-en">H₂O Dependence</span>
                                </button>
                                <button id="graph-type-acid" class="graph-type-btn bg-gray-200 text-gray-700 py-1 px-3 rounded-md text-sm">
                                    <span class="lang-ru">Зависимость от кислоты</span>
                                    <span class="lang-en">Acid Dependence</span>
                                </button>
                                <button id="graph-type-pressure" class="graph-type-btn bg-gray-200 text-gray-700 py-1 px-3 rounded-md text-sm">
                                    <span class="lang-ru">Зависимость от давления</span>
                                    <span class="lang-en">Pressure Dependence</span>
                                </button>
                                <button id="graph-type-compare" class="graph-type-btn bg-gray-200 text-gray-700 py-1 px-3 rounded-md text-sm">
                                    <span class="lang-ru">Сравнение методов</span>
                                    <span class="lang-en">Method Comparison</span>
                                </button>
                            </div>

                            <!-- Graph Canvas -->
                            <div class="bg-white border rounded-lg p-2" style="height: 400px;">
                                <canvas id="dewPointChart"></canvas>
                            </div>

                            <!-- Graph Description -->
                            <div class="mt-4 text-sm text-gray-600" id="graph-description">
                                <p class="lang-ru">График показывает зависимость точки росы от содержания воды (H₂O) при фиксированных значениях других параметров.</p>
                                <p class="lang-en">The graph shows the dependence of dew point on water content (H₂O) while other parameters remain fixed.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Theory Tab Content -->
            <div id="theory" class="tab-content fade-in" style="display: none;">
                <!-- Содержимое про теорию и формулы, без изменений -->
                <!-- ... -->
                <div class="card p-6 mb-6">
                    <h2 class="text-2xl font-bold mb-4 text-gray-800 border-b pb-2">
                        <i class="fas fa-book mr-2 text-blue-600"></i>
                        <span class="lang-ru">Теория и формулы</span>
                        <span class="lang-en">Theory & Formulas</span>
                    </h2>
                    <!-- Ниже идет ваш контент: описание, формулы, etc. -->
                    <!-- Я оставлю, чтобы весь код был цельным. -->
                    
                    <!-- ... (Ваша теория) ... -->
                </div>
            </div>

            <!-- Recommendations Tab Content -->
            <div id="recommendations" class="tab-content fade-in" style="display: none;">
                <!-- Содержимое рекомендаций... -->
                <!-- ... -->
            </div>

            <!-- References Tab Content -->
            <div id="references" class="tab-content fade-in" style="display: none;">
                <!-- Содержимое источников... -->
                <!-- ... -->
            </div>
        </main>

        <!-- Footer -->
        <footer class="mt-8 text-center text-gray-600 text-sm">
            <p class="lang-ru">Калькулятор точки росы кислотной коррозии. Разработан на основе научных формул и данных.</p>
            <p class="lang-en">Acid Dew Point Corrosion Calculator. Developed based on scientific formulas and data.</p>
            <p class="mt-1">© 2023</p>
        </footer>
    </div>

    <!-- JAVASCRIPT (Полный скрипт) -->
    <script>
        /* ======================== ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ======================== */
        let currentAcid = 'h2so4';
        let currentMethod = 'okkes';
        let currentGraphType = 'h2o';
        let dewPointChart = null;
        let currentLanguage = 'ru';

        /* ======================== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ====================== */
        function celsiusToFahrenheit(c) {
            return c * 9 / 5 + 32;
        }

        // Перевод общего давления в атм
        function convertPressureToAtm(value, unit) {
            if (unit === 'atm') {
                return value;
            } else if (unit === 'bar') {
                return value * 0.986923;
            } else if (unit === 'kPa') {
                return value * 0.00986923;
            } else if (unit === 'mmHg') {
                return value / 760;
            }
            return value;
        }

        // Конверсия в парциальное давление (atm)
        function convertToPartialPressureAtm(value, unit, totalPressureAtm, acidOrComp) {
            let fraction = 0;
            if (unit === 'percent') {
                fraction = value / 100.0;
            } else if (unit === 'ppm') {
                fraction = value / 1e6;
            } else if (unit === 'mg/nm3') {
                let M = 18.02;
                if (acidOrComp === 'so3') M = 80.06;
                if (acidOrComp === 'hcl') M = 36.46;
                if (acidOrComp === 'h2s') M = 34.08;
                if (acidOrComp === 'h2o') M = 18.02;
                const ppm = (value * 22.4) / M;
                fraction = ppm / 1e6;
            }
            return fraction * totalPressureAtm;
        }

        // Конверсия в парциальное давление (mmHg)
        function convertToPartialPressureMMHg(value, unit, totalPressureAtm, acidOrComp) {
            let fraction = 0;
            if (unit === 'percent') {
                fraction = value / 100.0;
            } else if (unit === 'ppm') {
                fraction = value / 1e6;
            } else if (unit === 'mg/nm3') {
                let M = 18.02;
                if (acidOrComp === 'so3') M = 80.06;
                if (acidOrComp === 'hcl') M = 36.46;
                if (acidOrComp === 'h2s') M = 34.08;
                if (acidOrComp === 'h2o') M = 18.02;
                const ppm = (value * 22.4) / M;
                fraction = ppm / 1e6;
            }
            return fraction * totalPressureAtm * 760;
        }

        // Упрощённо: точка росы воды
        function calcWaterDewPointApprox(pH2O_mmHg) {
            if (pH2O_mmHg < 0.0001) return -50;
            const td = 18.5 * Math.log(pH2O_mmHg) - 36.0;
            return td;
        }

        // ====================== H2SO4 ======================
        function calcH2SO4DewPoint(method, pH2O, pSO3) {
            // pH2O, pSO3 либо в мм рт.ст., либо в атм
            let dewC = -999;
            if (method === 'verhoff') {
                if (pH2O < 1e-8) pH2O = 1e-8;
                if (pSO3 < 1e-8) pSO3 = 1e-8;
                const lnH2O = Math.log(pH2O);
                const lnSO3 = Math.log(pSO3);
                const denom = 2.276 - 0.02943 * lnH2O - 0.0858 * lnSO3 + 0.0062 * lnH2O * lnSO3;
                const tK = 1000.0 / denom;
                dewC = tK - 273.15;
            } else if (method === 'okkes') {
                if (pH2O < 1e-15) pH2O = 1e-15;
                if (pSO3 < 1e-15) pSO3 = 1e-15;
                const logH2O = Math.log10(pH2O);
                const logSO3 = Math.log10(pSO3);
                dewC = 203.25
                    + 27.6 * logH2O
                    + 10.83 * logSO3
                    + 1.06 * Math.pow(logSO3 + 8, 2.19);
            } else if (method === 'zarenezhad') {
                if (pH2O < 1e-8) pH2O = 1e-8;
                if (pSO3 < 1e-8) pSO3 = 1e-8;
                const lnH2O = Math.log(pH2O);
                const lnSO3 = Math.log(pSO3);
                dewC = 150
                    + 8.1328 * lnH2O
                    + 11.664 * lnSO3
                    - 0.38226 * lnH2O * lnSO3;
            }
            // чтоб не было меньше 0
            if (dewC < 0) dewC = 0;
            return dewC;
        }

        // ====================== HCl (Kiang) ======================
        function calcHClDewPoint(pH2O_mmHg, pHCl_mmHg) {
            if (pH2O_mmHg < 1e-8) pH2O_mmHg = 1e-8;
            if (pHCl_mmHg < 1e-8) pHCl_mmHg = 1e-8;
            const lnH2O = Math.log(pH2O_mmHg);
            const lnHCl = Math.log(pHCl_mmHg);
            const denom = 3.7368 - 0.1591 * lnH2O - 0.0326 * lnHCl + 0.00269 * lnH2O * lnHCl;
            const tK = 1000.0 / denom;
            let dewC = tK - 273.15;
            if (dewC < 0) dewC = 0;
            return dewC;
        }

        // ====================== H2S (Antoine) ======================
        function calcH2SDewPoint(pH2S_mmHg) {
            if (pH2S_mmHg < 1e-12) return 0;  // можно вернуть 0 или -150, на ваш выбор
            const pBar = pH2S_mmHg / 750.06;
            if (pBar < 1e-12) return 0;
            const logP = Math.log10(pBar);
            if (logP >= 4.52887) return 76.4;
            const tK = 958.587 / (4.52887 - logP) + 0.539;
            let dewC = tK - 273.15;
            if (dewC < -60.3) {
                const tK2 = 829.439 / (4.43681 - logP) + 25.412;
                dewC = tK2 - 273.15;
            }
            if (dewC < 0) dewC = 0; // обрезаем
            return dewC;
        }

        /* ========================== ОСНОВНАЯ ФУНКЦИЯ ========================== */
        function performCalculations() {
            const waterContent = parseFloat(document.getElementById('water-content').value) || 0;
            const waterUnit = document.getElementById('water-units').value;
            const systemPressureVal = parseFloat(document.getElementById('system-pressure').value) || 1;
            const systemPressureUnit = document.getElementById('pressure-units').value;
            const pressureAtm = convertPressureToAtm(systemPressureVal, systemPressureUnit);

            const pH2O_mmHg = convertToPartialPressureMMHg(waterContent, waterUnit, pressureAtm, 'h2o');
            const pH2O_atm  = convertToPartialPressureAtm(waterContent, waterUnit, pressureAtm, 'h2o');

            document.getElementById('h2o-partial-pressure').textContent = pH2O_mmHg.toFixed(4) + ' мм рт.ст.';

            // вода
            const waterDewC = calcWaterDewPointApprox(pH2O_mmHg);
            const waterDewF = celsiusToFahrenheit(waterDewC);
            document.getElementById('water-dew-point').textContent = waterDewC.toFixed(1);
            document.getElementById('water-dew-point-f').textContent = `(${waterDewF.toFixed(1)} °F)`;

            if (currentAcid === 'h2so4') {
                const so3Val = parseFloat(document.getElementById('so3-content').value) || 0;
                const so3Unit = document.getElementById('so3-units').value;
                const pSO3_mmHg = convertToPartialPressureMMHg(so3Val, so3Unit, pressureAtm, 'so3');
                const pSO3_atm  = convertToPartialPressureAtm(so3Val, so3Unit, pressureAtm, 'so3');
                document.getElementById('so3-partial-pressure').textContent = pSO3_mmHg.toFixed(4) + ' мм рт.ст.';

                if (currentMethod === 'all') {
                    const dewOkkes = calcH2SO4DewPoint('okkes', pH2O_atm, pSO3_atm);
                    const dewVerh  = calcH2SO4DewPoint('verhoff', pH2O_mmHg, pSO3_mmHg);
                    const dewZare  = calcH2SO4DewPoint('zarenezhad', pH2O_mmHg, pSO3_mmHg);
                    const maxDP = Math.max(dewOkkes, dewVerh, dewZare);
                    const recTemp = maxDP + 10;

                    document.getElementById('okkes-result').textContent = dewOkkes.toFixed(1) + ' °C';
                    document.getElementById('verhoff-result').textContent = dewVerh.toFixed(1) + ' °C';
                    document.getElementById('zarenezhad-result').textContent = dewZare.toFixed(1) + ' °C';
                    document.getElementById('okkes-result-f').textContent = celsiusToFahrenheit(dewOkkes).toFixed(1) + ' °F';
                    document.getElementById('verhoff-result-f').textContent = celsiusToFahrenheit(dewVerh).toFixed(1) + ' °F';
                    document.getElementById('zarenezhad-result-f').textContent = celsiusToFahrenheit(dewZare).toFixed(1) + ' °F';

                    document.getElementById('max-result').textContent = maxDP.toFixed(1) + ' °C';
                    document.getElementById('max-result-f').textContent = celsiusToFahrenheit(maxDP).toFixed(1) + ' °F';
                    document.getElementById('recommended-result').textContent = recTemp.toFixed(1) + ' °C';
                    document.getElementById('recommended-result-f').textContent = celsiusToFahrenheit(recTemp).toFixed(1) + ' °F';

                    document.getElementById('h2so4-dew-point').textContent = maxDP.toFixed(1);
                    document.getElementById('h2so4-dew-point-f').textContent = `(${celsiusToFahrenheit(maxDP).toFixed(1)} °F)`;
                    document.getElementById('recommended-temp').textContent = recTemp.toFixed(1);
                    document.getElementById('recommended-temp-f').textContent = `(${celsiusToFahrenheit(recTemp).toFixed(1)} °F)`;

                    document.getElementById('single-method-results').style.display = 'none';
                    document.getElementById('comparison-results').style.display = 'block';
                } else {
                    let dewC = 0;
                    if (currentMethod === 'okkes') {
                        dewC = calcH2SO4DewPoint('okkes', pH2O_atm, pSO3_atm);
                    } else if (currentMethod === 'verhoff') {
                        dewC = calcH2SO4DewPoint('verhoff', pH2O_mmHg, pSO3_mmHg);
                    } else {
                        dewC = calcH2SO4DewPoint('zarenezhad', pH2O_mmHg, pSO3_mmHg);
                    }
                    const dewF = celsiusToFahrenheit(dewC);
                    const recTemp = dewC + 10;
                    const recTempF = celsiusToFahrenheit(recTemp);

                    document.getElementById('h2so4-dew-point').textContent = dewC.toFixed(1);
                    document.getElementById('h2so4-dew-point-f').textContent = `(${dewF.toFixed(1)} °F)`;
                    document.getElementById('recommended-temp').textContent = recTemp.toFixed(1);
                    document.getElementById('recommended-temp-f').textContent = `(${recTempF.toFixed(1)} °F)`;

                    document.getElementById('single-method-results').style.display = 'flex';
                    document.getElementById('comparison-results').style.display = 'none';
                }
                updateRiskAssessment('h2so4');
            }
            else if (currentAcid === 'hcl') {
                const hclVal = parseFloat(document.getElementById('hcl-content').value) || 0;
                const hclUnit = document.getElementById('hcl-units').value;
                const pHCl_mmHg = convertToPartialPressureMMHg(hclVal, hclUnit, pressureAtm, 'hcl');
                document.getElementById('hcl-partial-pressure').textContent = pHCl_mmHg.toFixed(4) + ' мм рт.ст.';

                const dewC = calcHClDewPoint(pH2O_mmHg, pHCl_mmHg);
                const dewF = celsiusToFahrenheit(dewC);
                const recTemp = dewC + 10;
                const recTempF = celsiusToFahrenheit(recTemp);

                document.getElementById('h2so4-dew-point').textContent = dewC.toFixed(1);
                document.getElementById('h2so4-dew-point-f').textContent = `(${dewF.toFixed(1)} °F)`;
                document.getElementById('recommended-temp').textContent = recTemp.toFixed(1);
                document.getElementById('recommended-temp-f').textContent = `(${recTempF.toFixed(1)} °F)`;

                document.getElementById('single-method-results').style.display = 'flex';
                document.getElementById('comparison-results').style.display = 'none';
                updateRiskAssessment('hcl');
            }
            else if (currentAcid === 'h2s') {
                const h2sVal = parseFloat(document.getElementById('h2s-content').value) || 0;
                const h2sUnit = document.getElementById('h2s-units').value;
                const pH2S_mmHg = convertToPartialPressureMMHg(h2sVal, h2sUnit, pressureAtm, 'h2s');
                document.getElementById('h2s-partial-pressure').textContent = pH2S_mmHg.toFixed(4) + ' мм рт.ст.';

                let dewC = calcH2SDewPoint(pH2S_mmHg);
                const dewF = celsiusToFahrenheit(dewC);

                const waterDewC = waterDewPoint; // получим из кода выше
                // но мы уже считали waterDewC, да:
                // const waterDewC = calcWaterDewPointApprox(pH2O_mmHg);
                // => у нас есть waterDewC

                const recBase = Math.max(dewC, waterDewC);
                const recTemp = recBase + 10;
                const recTempF = celsiusToFahrenheit(recTemp);

                document.getElementById('h2so4-dew-point').textContent = dewC.toFixed(1);
                document.getElementById('h2so4-dew-point-f').textContent = `(${dewF.toFixed(1)} °F)`;
                document.getElementById('recommended-temp').textContent = recTemp.toFixed(1);
                document.getElementById('recommended-temp-f').textContent = `(${recTempF.toFixed(1)} °F)`;

                document.getElementById('single-method-results').style.display = 'flex';
                document.getElementById('comparison-results').style.display = 'none';
                updateRiskAssessment('h2s');
            }

            updateGraph();
        }

        /* ===================== ОЦЕНКА РИСКА ===================== */
        function updateRiskAssessment(acidType) {
            const riskAssessment = document.getElementById('risk-assessment');
            const riskDescription = document.getElementById('risk-description');

            if (acidType === 'h2so4') {
                riskAssessment.className = "mt-6 p-4 rounded-lg bg-blue-50";
                if (currentLanguage === 'ru') {
                    riskDescription.innerHTML = "При работе оборудования ниже точки росы H₂SO₄ возможна интенсивная коррозия.";
                } else {
                    riskDescription.innerHTML = "Operating below H₂SO₄ dew point can cause severe corrosion.";
                }
            }
            else if (acidType === 'hcl') {
                riskAssessment.className = "mt-6 p-4 rounded-lg bg-green-50";
                if (currentLanguage === 'ru') {
                    riskDescription.innerHTML = "HCl-конденсат опасен даже для нержавеющих сталей 300-й серии.";
                } else {
                    riskDescription.innerHTML = "HCl condensate is dangerous even for 300-series SS.";
                }
            }
            else if (acidType === 'h2s') {
                riskAssessment.className = "mt-6 p-4 rounded-lg bg-purple-50";
                if (currentLanguage === 'ru') {
                    riskDescription.innerHTML = "Влажный H₂S вызывает сульфидное растрескивание под напряжением.";
                } else {
                    riskDescription.innerHTML = "Wet H₂S causes sulfide stress cracking.";
                }
            }
        }

        /* ============================ ГРАФИК ============================ */
        function updateGraph() {
            // Ваша логика построения графика.
            // Ниже — просто заглушка, чтобы не было сокращений.
            const ctx = document.getElementById('dewPointChart').getContext('2d');
            if (dewPointChart) {
                dewPointChart.destroy();
            }

            let labels = [1,2,3,4,5];
            let data1 = [10,15,20,25,30];
            let data2 = [5,7,9,12,15];
            dewPointChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Method X',
                            data: data1,
                            borderColor: 'rgba(54, 162, 235, 1)',
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            fill: false
                        },
                        {
                            label: 'Water DP',
                            data: data2,
                            borderColor: 'rgba(75, 192, 192, 1)',
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            fill: false,
                            borderDash: [5,5]
                        }
                    ]
                },
                options: {}
            });
        }

        /* ======================== ИНИЦИАЛИЗАЦИЯ ======================== */
        document.addEventListener('DOMContentLoaded', function() {
            setLanguage('ru');

            document.querySelectorAll('.acid-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.acid-type-btn').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    this.classList.remove('bg-gray-200','text-gray-700');
                    this.classList.add('btn-primary');

                    currentAcid = this.getAttribute('data-acid');

                    document.getElementById('so3-content-container').style.display = (currentAcid === 'h2so4') ? 'block' : 'none';
                    document.getElementById('hcl-content-container').style.display = (currentAcid === 'hcl') ? 'block' : 'none';
                    document.getElementById('h2s-content-container').style.display = (currentAcid === 'h2s') ? 'block' : 'none';

                    document.getElementById('so3-partial-section').style.display = (currentAcid === 'h2so4') ? 'block' : 'none';
                    document.getElementById('hcl-partial-section').style.display = (currentAcid === 'hcl') ? 'block' : 'none';
                    document.getElementById('h2s-partial-section').style.display = (currentAcid === 'h2s') ? 'block' : 'none';

                    document.getElementById('method-selection-h2so4').style.display = (currentAcid === 'h2so4') ? 'block' : 'none';
                    document.getElementById('method-selection-hcl').style.display = (currentAcid === 'hcl') ? 'block' : 'none';
                    document.getElementById('method-selection-h2s').style.display = (currentAcid === 'h2s') ? 'block' : 'none';

                    if (currentAcid === 'h2so4') {
                        currentMethod = document.getElementById('calculation-method-h2so4').value;
                    } else if (currentAcid === 'hcl') {
                        currentMethod = document.getElementById('calculation-method-hcl').value;
                    } else if (currentAcid === 'h2s') {
                        currentMethod = document.getElementById('calculation-method-h2s').value;
                    }
                    performCalculations();
                });
            });

            document.getElementById('calculation-method-h2so4').addEventListener('change', function(){
                currentMethod = this.value;
                if (currentMethod === 'all') {
                    document.getElementById('comparison-results').style.display = 'block';
                    document.getElementById('single-method-results').style.display = 'none';
                } else {
                    document.getElementById('comparison-results').style.display = 'none';
                    document.getElementById('single-method-results').style.display = 'flex';
                }
                performCalculations();
            });

            document.getElementById('calculation-method-hcl').addEventListener('change', function(){
                currentMethod = this.value;
                performCalculations();
            });

            document.getElementById('calculation-method-h2s').addEventListener('change', function(){
                currentMethod = this.value;
                performCalculations();
            });

            // Graph type
            document.querySelectorAll('.graph-type-btn').forEach(btn => {
                btn.addEventListener('click', function(){
                    document.querySelectorAll('.graph-type-btn').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('bg-gray-200','text-gray-700');
                    });
                    this.classList.remove('bg-gray-200','text-gray-700');
                    this.classList.add('btn-primary');
                    currentGraphType = this.id.replace('graph-type-','');
                    updateGraph();
                });
            });

            // Inputs/sliders
            const inputPairs = [
                {inputId:'water-content',sliderId:'water-content-slider'},
                {inputId:'so3-content',sliderId:'so3-content-slider'},
                {inputId:'hcl-content',sliderId:'hcl-content-slider'},
                {inputId:'h2s-content',sliderId:'h2s-content-slider'},
                {inputId:'system-pressure',sliderId:'system-pressure-slider'}
            ];
            inputPairs.forEach(item=>{
                const inputEl = document.getElementById(item.inputId);
                const sliderEl= document.getElementById(item.sliderId);
                inputEl.addEventListener('input', function(){
                    sliderEl.value = this.value;
                    performCalculations();
                });
                sliderEl.addEventListener('input', function(){
                    inputEl.value = this.value;
                    performCalculations();
                });
            });

            // Unit selects
            const unitSel = ['water-units','so3-units','hcl-units','h2s-units','pressure-units'];
            unitSel.forEach(uid=>{
                document.getElementById(uid).addEventListener('change', function(){
                    performCalculations();
                });
            });

            // Calculate button
            document.getElementById('calculate-btn').addEventListener('click', function(){
                performCalculations();
            });

            // Tab navigation
            document.querySelectorAll('.tab-btn').forEach(btn=>{
                btn.addEventListener('click', function(){
                    const tabId = this.getAttribute('data-tab');
                    document.querySelectorAll('.tab-content').forEach(tc=>{
                        tc.style.display='none';
                        tc.classList.remove('fade-in');
                    });
                    document.getElementById(tabId).style.display='block';
                    setTimeout(()=>{document.getElementById(tabId).classList.add('fade-in');},10);

                    document.querySelectorAll('.tab-btn').forEach(b=>{
                        b.classList.remove('tab-active');
                    });
                    this.classList.add('tab-active');

                    if(tabId==='calculator' && dewPointChart){
                        dewPointChart.update();
                    }
                });
            });

            // Language toggle
            document.getElementById('langToggle').addEventListener('click', function(){
                if(currentLanguage==='ru'){
                    setLanguage('en');
                } else {
                    setLanguage('ru');
                }
            });

            // init
            performCalculations();
        });

        function setLanguage(lang){
            currentLanguage = lang;
            if(lang==='ru'){
                document.querySelectorAll('.lang-ru').forEach(el=>{el.style.display='inline-block';});
                document.querySelectorAll('.lang-en').forEach(el=>{el.style.display='none';});
                document.documentElement.lang='ru';
            } else {
                document.querySelectorAll('.lang-ru').forEach(el=>{el.style.display='none';});
                document.querySelectorAll('.lang-en').forEach(el=>{el.style.display='inline-block';});
                document.documentElement.lang='en';
            }
            if(dewPointChart){
                updateGraph();
            }
        }
    </script>
</body>
</html>